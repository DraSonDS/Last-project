some huge fixes to this programm